## Практическая работа №1. Вуйко Ярослава, ЭФМО-01-25

Разделение монолита на 2 микросервиса. Взаимодействие через HTTP. 26.02.2026

## Короткое описание границ сервисов
### Auth Service
Отвечает за аутентификацию и проверку токенов доступа. Сервис предоставляет два эндпоинта:
1. POST /v1/auth/login - принимает учетные данные пользователя и возвращает токен доступа
2. GET /v1/auth/verify - проверяет валидность токена, и возвращает информацию о пользователе

### Tasks Service
Управляет задачами пользователя. Сервис реализует CRUD операции:
1. POST /v1/tasks - создание новой задачи
2. GET /v1/tasks - получение списка всех задач
3. GET /v1/tasks/{id} - получение задачи по ID
4. PATCH /v1/tasks/{id} - обновление задачи
5. DELETE /v1/tasks/{id} - удаление задачи

### Подробнее об эндпоинтах можно посмтореть в папке [docs/pz17_api.md](docs/pz17_api.md)


## Структура проекта

```
.
│   go.mod
│   go.sum
│   README.md
├───docs/
│     ├───  pz17_api.md
│     └───  pz17_diagram.md
├───services/
│   ├───auth/
│   │   ├───go.mod
│   │   ├───go.sum
│   │   ├───cmd/
│   │   │   └───auth/
│   │   │          └─── main.go
│   │   └───internal/
│   │       ├───handler/
│   │       │       └─── auth_handler.go
│   │       └───service/
│   │               └─── auth_servise.go
│   └───tasks/
│       │   go.mod
│       │   go.sum
│       ├───cmd/
│       │   └───tasks/
│       │           └───main.go
│       └───internal/
│           ├───client/
│           │       └───auth_client.go
│           ├───handler/
│           │       └───task_handler.go
│           └───service/
│                   └───task_service.go
└───shared/
    ├───httpx/
    │       └───client.go
    ├───middleware/
    │       ├───logging.go
    │       └───requestid.go
    └───models/
            └───models.go
```



### Скрины логов с request-id, подтверждающий прокидывание
<img width="821" height="222" alt="2026-02-26_18-46-44" src="https://github.com/user-attachments/assets/909bbae1-4f44-4a7f-b4d4-d8fa609dc103" />
<img width="902" height="260" alt="2026-02-26_18-46-53" src="https://github.com/user-attachments/assets/8dec2191-e585-4315-9fd6-429ebdaec50c" />

### Требования
- Go 1.21 или выше
- Порт 8081 для сервиса авторизации и 8082 для сервися заданы должны быть свободны

### Инструкция по запуску
1. Скопировать репозиторий
   ```
   https://github.com/Yaroslavaaaa/tech-ip-sem2-pz1.git
   ```
2. Войти в папку где лежит сервис авторизации и запустить его
   ```
   cd services/auth
   go run ./cmd/auth
   ```
3. Веонуться в корневую папку и войти в папкус где лежит сервис задач
   ```
   cd ../..
   cd services/tasks
   go run ./cmd/tasks
   ```
4. Приложение готово к использованию
   

## Ответы на контрольные вопросы:
1. Почему межсервисный вызов должен иметь таймаут?
Таймаут необходим, чтобы предотвратить бесконечное ожидание ответа от зависшего или медленного сервиса, что может привести к исчерпанию ресурсов и каскадным сбоям во всей системе.
2. Чем request-id помогает при диагностике ошибок?
Request-id позволяет отследить путь конкретного запроса через все микросервисы, связывая логи разных сервисов в единую цепочку, что значительно упрощает поиск причин ошибок и анализ проблем производительности.
3. Какие статусы нужно вернуть клиенту при невалидном токене?
При невалидном токене сервис должен вернуть статус 401 Unauthorized, а при отсутствии токена или неправильном формате Authorization заголовка также 401 Unauthorized с соответствующим сообщением об ошибке.
4. Чем опасно “делить одну БД” между сервисами?
Общая БД создает скрытую связанность между сервисами, лишает их независимости в развитии и масштабировании, усложняет изменение схемы данных и нарушает принцип слабой связанности микросервисной архитектуры.






